# Replace steamviewdashboard.online with your domain and set a real email for TLS
steamviewdashboard.online, www.steamviewdashboard.online {
  encode zstd gzip
  tls andrewprudlow@gmail.com

  # API + auth paths routed to the gateway
  handle_path /auth/* {
    reverse_proxy api-gateway:4000
  }
  handle_path /metadata/* {
    reverse_proxy api-gateway:4000
  }
  handle_path /stats/* {
    reverse_proxy api-gateway:4000
  }
  handle_path /players/* {
    reverse_proxy api-gateway:4000
  }
  handle_path /steam/* {
    reverse_proxy api-gateway:4000
  }
  handle_path /live/* {
    reverse_proxy api-gateway:4000
  }

  # Everything else goes to the web SPA
  handle {
    reverse_proxy web:4173
  }
}
